<% provide(:title, @puzzle.title) %>
<div class="puzzle">

<!--
########### TOP INFORMATION FIELD ####################
-->

<!--
########### PREV/NEXT PUZZLE LINKS ####################
-->
  <p id="next_prev_links">
  <%
    if !@prev_puzzle.nil?
      %><%= link_to "<< Previous Puzzle", puzzle_path(@prev_puzzle) %><%
    end
    if (!@prev_puzzle.nil?) && (!@next_puzzle.nil?)
      %>&nbsp;&nbsp;|&nbsp;&nbsp;<%
    end
    if !@next_puzzle.nil?
      %><%= link_to "Next Puzzle >>", puzzle_path(@next_puzzle)%><%
    end
  %>
  </p>


<div id="puzzle_grid_and_info">

  <%= render partial: "/partials/puzzle_info_bar", locals: {title: @puzzle.title, date: @puzzle.publication_date, source: @puzzle.sources[0].name, constructors: @puzzle.constructors, size: @width.to_s + "x" + @height.to_s, type: @puzzle.puzzle_type} %>


<!--
########### DISPLAY PUZZLE GRID ####################
-->
  <div id="puzzle_grid">
  <%
    if @special_type.eql?("outer")
      %><table class="solution_grid_with_outer"><%
    else
      %><table class="solution_grid"><%
    end
  %>
  <%
    @the_grid.each do |this_row|
      %><tr><%
      this_row.each do |this_square|
        %>
	  <td class="<%= this_square.class_name %>">
	  <div class="<%= this_square.class_name %>" id="<%= this_square.id_name %>">
	    <%
#	      if this_square.class_name.eql?("black_square")
#	        %>&nbsp;<%
#	      else
	        %>
		  <div class="number"><%= @grid_numbers[this_square.id_name].html_safe %></div>
		  <div class="letter"><%= this_square.contents %></div>	      
	        <%
#	      end
	    %>
	  </div>
	  </td>
        <%
      end
      %></tr><%
    end
    %>
    </table>
  </div>

  <div style="clear: both;">&nbsp;</div>


<!--
########### BOTTOM INFORMATION FIELD ####################
-->
<!--
<p class="bottom_information_field" id="copyright">&nbsp;</p>
<p id="notepad">Notepad: </p>
<p id="my_notes">Peter's notes: </p>
<p id="meta_solution">Solution: </p>
<p id="meta_explanation">Explanation: </p>
-->

<!--
########### THEME EXPLANATION BOX ####################
-->
<%
  if !@puzzle.explanation.nil?
    %><div class="theme_explanation"><%
      if !@meta_answer.nil?
        %><p>Meta Answer: <b><%= @meta_answer %></b></p><%
      end
      %><p><%= @theme_explanation.html_safe %></p>
    </div><%
  end
%>
<hr />

</div> <!-- end of puzzle_grid_and_info -->


<!--
########### RIGHT INFORMATION FIELD ####################
-->

  <div id="puzzle_small_info">
    <table id="small_info_table">
      <tr>
	<td class="small_field_name">
	  Average word length
	</td>
	<td class="small_field_value">
	  5.5
	</td>
      </tr>
      <tr>
	<td class="small_field_name">
	  Scrabble average
	</td>
	<td class="small_field_value">
	  3.5
	</td>
      </tr>
      <tr>
	<td class="small_field_name">
	  Some other field
	</td>
	<td class="small_field_value">
	  ???
	</td>
      </tr>
      <%
	@letter_order.each do |l|
	  %><tr><%
	    %><td class="small_field_name"><%= l %></td><%
	    %><td class="small_field_value"><%= @letter_counts[l] %></td><%
	  %></tr><%
	end
      %>
    </table>
  </div>


<!--
########### CLUE/ANSWER LIST ####################
-->
<table class="clue_table">
<tr>
  <th>Across</th>
  <th>Down</th>
</tr>
<tr>
  <td>
    <ul class="clue_list">
    <% 
	@a_clues.each do |c|
	  %><li>	      
	      <span class="clue_number"><%= c.number %>.&nbsp;</span>
	      <span class="clue_and_answer">
		<span class="clue_text"><%= c.clue.html_safe %>&nbsp;</span> 	      
	        <span class="clue_answer"><%= c.answer %></span>
	      </span>
	  </li><%
	end
    %>
    </ul>
  </td>
  <td>
    <ul class="clue_list">
    <% 
	@d_clues.each do |c|
	  %><li>	      
	      <span class="clue_number"><%= c.number %>.&nbsp;</span>
	      <span class="clue_and_answer">
		<span class="clue_text"><%= c.clue.html_safe %>&nbsp;</span> 	      
	        <span class="clue_answer"><%= c.answer %></span>
	      </span>
	  </li><%
	end
    %>
    </ul>
  </td>
</tr>
</table>

</div>

